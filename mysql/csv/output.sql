SET SESSION group_concat_max_len=100000;

SET @TARGET_SCHEMA:='0202HokudaiKakunin';
SET @TARGET_TABLE:='settings';
SET @OUT_FILE:='/Users/mini/practice/0804/mysql/csv/settings.csv';

SELECT CONCAT("'",GROUP_CONCAT(COLUMN_NAME SEPARATOR "','"),"'") INTO @HEADER FROM (
SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_SCHEMA=@TARGET_SCHEMA AND TABLE_NAME=@TARGET_TABLE
ORDER BY ORDINAL_POSITION
) AAA;
SET @SQL:=CONCAT("SELECT * INTO OUTFILE '",@OUT_FILE,"' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '\"' FROM (SELECT ",@HEADER," UNION SELECT * FROM ",@TARGET_SCHEMA,".",@TARGET_TABLE,") AAA");
PREPARE stmt FROM @SQL;
EXECUTE stmt;
DEALLOCATE PREPARE stmt;